<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Image Viewer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: Arial, Helvetica, sans-serif;
    display: flex;
    flex-direction: column;
    height: 100vh;
}
header {
    padding: 0.75rem;
    background: #222;
    color: white;
    text-align: center;
}
main {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
}
img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}
footer {
    padding: 0.75rem;
    text-align: center;
}
</style>
</head>

<body>

<header id="caption"></header>

<main>
    <img id="image" src="" alt="">
</main>

<footer>
    <button id="prev">◀ Previous</button>
    <button id="next">Next ▶</button>
    &nbsp;|&nbsp;
    <a href="javascript:window.close()">Close</a>
</footer>

<script>
const data = JSON.parse(
    decodeURIComponent(window.location.hash.substring(1))
);

let index = data.index;
const items = data.items;

const img = document.getElementById("image");
const cap = document.getElementById("caption");

function render() {
    img.src = items[index].src;
    img.alt = items[index].caption;
    cap.textContent = items[index].caption;
}

document.getElementById("next").onclick = () => {
    index = (index + 1) % items.length;
    render();
};

document.getElementById("prev").onclick = () => {
    index = (index - 1 + items.length) % items.length;
    render();
};

document.addEventListener("keydown", e => {
    if (e.key === "ArrowRight") document.getElementById("next").click();
    if (e.key === "ArrowLeft") document.getElementById("prev").click();
    if (e.key === "Escape") window.close();
});

render();
</script>

</body>
</html>
